-- Salt V5.2 — V5 + tabs + fixed particles inside + no overlap
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local mouse = player:GetMouse()
local camera = Workspace.CurrentCamera

local Settings = {
    Fly = false, FlySpeed = 50,
    Noclip = false,
    Speed = 16,
    InfiniteJump = false,
    ESP = false,
    Aimbot = false, AimbotFOV = 120, AimbotSmooth = 0.15, TeamCheck = true
}

local flyBodyVelocity = nil
local noclipConnection = nil
local espConnection = nil
local aimbotConnection = nil
local drawings = {boxes = {}, names = {}, fovCircle = nil}

-- GUI — один раз, высокий приоритет
local sg = Instance.new("ScreenGui")
sg.Name = "SaltGUI"
sg.ResetOnSpawn = false
sg.ZIndexBehavior = Enum.ZIndexBehavior.Global
sg.DisplayOrder = 999  -- самый верх
sg.Parent = game:GetService("CoreGui")

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 250, 0, 380)  -- чуть меньше, чтобы не вылезало
mainFrame.Position = UDim2.new(0, 15, 0, 15)
mainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true  -- !ВАЖНО — точки не вылетят за меню
mainFrame.Parent = sg
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 12)

-- Shadow
local shadow = Instance.new("Frame")
shadow.Size = UDim2.new(1, 8, 1, 8)
shadow.Position = UDim2.new(0, -4, 0, -4)
shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
shadow.BackgroundTransparency = 0.7
shadow.ZIndex = -1
shadow.Parent = mainFrame
Instance.new("UICorner", shadow).CornerRadius = UDim.new(0, 16)

-- Title + drag
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 45)
title.BackgroundTransparency = 1
title.Text = "Salt V5.2"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 28
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Center
title.ZIndex = 20
title.Parent = mainFrame

local dragging, dragStart, startPos
title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)
title.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
end)

-- Табы (кнопки + содержимое)
local tabBar = Instance.new("Frame")
tabBar.Size = UDim2.new(1, -20, 0, 35)
tabBar.Position = UDim2.new(0, 10, 0, 50)
tabBar.BackgroundTransparency = 1
tabBar.ZIndex = 15
tabBar.Parent = mainFrame

local tabs = {"Movement", "Visuals", "Combat"}
local tabContents = {}

for i, tabName in ipairs(tabs) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1/#tabs - 0.02, 0, 1, 0)
    btn.Position = UDim2.new((i-1)/#tabs, 5, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    btn.Text = tabName
    btn.TextColor3 = Color3.fromRGB(200, 200, 200)
    btn.Font = Enum.Font.GothamSemibold
    btn.TextSize = 16
    btn.ZIndex = 16
    btn.Parent = tabBar
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)

    local content = Instance.new("ScrollingFrame")
    content.Size = UDim2.new(1, -20, 1, -100)
    content.Position = UDim2.new(0, 10, 0, 90)
    content.BackgroundTransparency = 1
    content.BorderSizePixel = 0
    content.ScrollBarThickness = 5
    content.CanvasSize = UDim2.new(0, 0, 0, 500)
    content.Visible = (tabName == "Movement")
    content.ZIndex = 12
    content.Parent = mainFrame
    tabContents[tabName] = content

    btn.MouseButton1Click:Connect(function()
        for _, c in pairs(tabContents) do c.Visible = false end
        tabContents[tabName].Visible = true
        for _, b in pairs(tabBar:GetChildren()) do if b:IsA("TextButton") then b.BackgroundColor3 = Color3.fromRGB(45, 45, 45) end end
        btn.BackgroundColor3 = Color3.fromRGB(0, 170, 100)
    end)
end

-- Particles — строго внутри, медленно, dt
local particles = {}
for i = 1, 50 do
    local p = Instance.new("Frame")
    p.Size = UDim2.new(0, 3, 0, 3)
    p.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    p.BackgroundTransparency = 0.5
    p.BorderSizePixel = 0
    p.ZIndex = 8
    p.Parent = mainFrame
    Instance.new("UICorner", p).CornerRadius = UDim.new(1, 0)
    particles[i] = {obj = p, phase = math.random() * math.pi * 2}
end

local lastT = tick()
RunService.Heartbeat:Connect(function()
    local dt = tick() - lastT
    lastT = tick()
    for _, data in ipairs(particles) do
        data.phase = data.phase + dt * 0.6  -- очень медленно, регулируй 0.6
        local x = math.clamp(0.05 + math.sin(data.phase) * 0.9, 0, 1)
        local y = math.clamp(0.05 + math.cos(data.phase * 1.4) * 0.9, 0, 1)
        data.obj.Position = UDim2.new(x, 0, y, 0)
        data.obj.BackgroundTransparency = 0.35 + math.sin(data.phase * 5) * 0.25
    end
end)

-- Остальные функции (Fly, Noclip, ESP, Aimbot) — как в твоей V5, без изменений
-- Вставь сюда toggleFly, toggleNoclip, toggleESP, toggleAimbot из V5
-- (Fly RenderStepped, ESP RenderStepped с cleanup, Aimbot auto на зелёных)

-- Пример: auto aimbot (если был в V5)
RunService.RenderStepped:Connect(function()
    if Settings.Aimbot then
        -- твоя логика поиска ближайшего зелёного и Lerp камеры
    end
end)

print("Salt V5.2 загружен — меню чистое, точки внутри, ничего не накладывается!")
