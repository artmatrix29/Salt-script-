-- salt v2 | Полный хаб с вкладками Defense, Attack, Misc

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")
local WS = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local Player = Players.LocalPlayer
local Mouse = Player:GetMouse()

local flying = false
local noclipping = false
local antiGrab = false
local backTP = false
local grabReach = 100  -- регулируемая дальность граба
local pullStrength = 10  -- сила оттягивания на колесо
local throwStrength = 1500  -- сила броска на ПКМ
local tracking = false
local selectedTarget = nil
local tpKey = Enum.KeyCode.Z  -- настраиваемая кнопка для TP

-- GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "saltv2"
ScreenGui.ResetOnSpawn = false
ScreenGui.DisplayOrder = 9999
ScreenGui.IgnoreGuiInset = true
ScreenGui.Parent = Player:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Name = "Main"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.new(0,0,0)
MainFrame.Position = UDim2.new(0.5, -250, 0.5, -200)
MainFrame.Size = UDim2.new(0, 500, 0, 450)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

local UICorner = Instance.new("UICorner", MainFrame)
UICorner.CornerRadius = UDim.new(0,12)

local Title = Instance.new("TextLabel")
Title.Parent = MainFrame
Title.BackgroundTransparency = 1
Title.Size = UDim2.new(1,0,0,50)
Title.Font = Enum.Font.GothamBold
Title.Text = "salt v2"
Title.TextColor3 = Color3.fromRGB(0,255,128)
Title.TextScaled = true

local CloseBtn = Instance.new("TextButton")
CloseBtn.Parent = MainFrame
CloseBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
CloseBtn.Position = UDim2.new(1,-45,0,8)
CloseBtn.Size = UDim2.new(0,35,0,35)
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255,80,80)
CloseBtn.TextScaled = true
local cc = Instance.new("UICorner", CloseBtn)
cc.CornerRadius = UDim.new(0,8)

-- Вкладки Defense, Attack, Misc
local TabFrame = Instance.new("Frame")
TabFrame.Parent = MainFrame
TabFrame.BackgroundColor3 = Color3.fromRGB(20,20,20)
TabFrame.Position = UDim2.new(0,10,0,60)
TabFrame.Size = UDim2.new(1,-20,0,40)

local tabs = {
    Defense = Instance.new("TextButton", TabFrame),
    Attack = Instance.new("TextButton", TabFrame),
    Misc = Instance.new("TextButton", TabFrame)
}

local tabPages = {}

local function createTab(name, x)
    local btn = tabs[name]
    btn.Position = UDim2.new(x,0,0,0)
    btn.Size = UDim2.new(0.33,0,1,0)
    btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
    btn.Text = name
    btn.TextColor3 = Color3.fromRGB(0,255,128)
    btn.TextScaled = true
    btn.Font = Enum.Font.GothamBold
    local cor = Instance.new("UICorner", btn)
    cor.CornerRadius = UDim.new(0,8)
    
    local page = Instance.new("Frame")
    page.Parent = MainFrame
    page.BackgroundTransparency = 1
    page.Position = UDim2.new(0,10,0,110)
    page.Size = UDim2.new(1,-20,1,-170)
    page.Visible = false
    tabPages[name] = page
    
    btn.MouseButton1Click:Connect(function()
        for _, p in pairs(tabPages) do p.Visible = false end
        tabPages[name].Visible = true
    end)
end

createTab("Defense", 0)
createTab("Attack", 0.33)
createTab("Misc", 0.66)

tabPages.Defense.Visible = true  -- по умолчанию Defense

-- Defense Page
local AntiGrabBtn = Instance.new("TextButton", tabPages.Defense)
AntiGrabBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
AntiGrabBtn.Position = UDim2.new(0.05,0,0.1,0)
AntiGrabBtn.Size = UDim2.new(0.9,0,0,50)
AntiGrabBtn.Text = "Anti-Grab: OFF"
AntiGrabBtn.TextColor3 = Color3.fromRGB(200,200,200)
AntiGrabBtn.TextScaled = true

local BackTPBtn = Instance.new("TextButton", tabPages.Defense)
BackTPBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
BackTPBtn.Position = UDim2.new(0.05,0,0.25,0)
BackTPBtn.Size = UDim2.new(0.9,0,0,50)
BackTPBtn.Text = "Back TP on Grab: OFF"
BackTPBtn.TextColor3 = Color3.fromRGB(200,200,200)
BackTPBtn.TextScaled = true

-- Attack Page
local ReachLabel = Instance.new("TextLabel", tabPages.Attack)
ReachLabel.BackgroundTransparency = 1
ReachLabel.Position = UDim2.new(0.05,0,0.1,0)
ReachLabel.Size = UDim2.new(0.9,0,0,30)
ReachLabel.Text = "Grab Reach: 100"
ReachLabel.TextColor3 = Color3.fromRGB(0,255,128)
ReachLabel.TextScaled = true

local SliderTrackReach = Instance.new("Frame", tabPages.Attack)
SliderTrackReach.BackgroundColor3 = Color3.fromRGB(30,30,30)
SliderTrackReach.Position = UDim2.new(0.05,0,0.15,0)
SliderTrackReach.Size = UDim2.new(0.9,0,0,20)

local SliderFillReach = Instance.new("Frame", SliderTrackReach)
SliderFillReach.BackgroundColor3 = Color3.fromRGB(0,255,128)
SliderFillReach.Size = UDim2.new(0.5,0,1,0)

local PullStrengthLabel = Instance.new("TextLabel", tabPages.Attack)
PullStrengthLabel.BackgroundTransparency = 1
PullStrengthLabel.Position = UDim2.new(0.05,0,0.25,0)
PullStrengthLabel.Size = UDim2.new(0.9,0,0,30)
PullStrengthLabel.Text = "Pull Strength (Wheel): 10"
PullStrengthLabel.TextColor3 = Color3.fromRGB(0,255,128)
PullStrengthLabel.TextScaled = true

local SliderTrackPull = Instance.new("Frame", tabPages.Attack)
SliderTrackPull.BackgroundColor3 = Color3.fromRGB(30,30,30)
SliderTrackPull.Position = UDim2.new(0.05,0,0.3,0)
SliderTrackPull.Size = UDim2.new(0.9,0,0,20)

local SliderFillPull = Instance.new("Frame", SliderTrackPull)
SliderFillPull.BackgroundColor3 = Color3.fromRGB(0,255,128)
SliderFillPull.Size = UDim2.new(0.5,0,1,0)

local ThrowStrengthLabel = Instance.new("TextLabel", tabPages.Attack)
ThrowStrengthLabel.BackgroundTransparency = 1
ThrowStrengthLabel.Position = UDim2.new(0.05,0,0.4,0)
ThrowStrengthLabel.Size = UDim2.new(0.9,0,0,30)
ThrowStrengthLabel.Text = "Throw Strength (RMB): 1500"
ThrowStrengthLabel.TextColor3 = Color3.fromRGB(0,255,128)
ThrowStrengthLabel.TextScaled = true

local SliderTrackThrow = Instance.new("Frame", tabPages.Attack)
SliderTrackThrow.BackgroundColor3 = Color3.fromRGB(30,30,30)
SliderTrackThrow.Position = UDim2.new(0.05,0,0.45,0)
SliderTrackThrow.Size = UDim2.new(0.9,0,0,20)

local SliderFillThrow = Instance.new("Frame", SliderTrackThrow)
SliderFillThrow.BackgroundColor3 = Color3.fromRGB(0,255,128)
SliderFillPull.Size = UDim2.new(0.5,0,1,0)

-- Misc Page
local PlayersScroll = Instance.new("ScrollingFrame", tabPages.Misc)
PlayersScroll.BackgroundColor3 = Color3.fromRGB(10,10,0)
PlayersScroll.Position = UDim2.new(0.05,0,0.1,0)
PlayersScroll.Size = UDim2.new(0.9,0,0.3,0)
PlayersScroll.ScrollBarImageColor3 = Color3.fromRGB(0,255,128)
PlayersScroll.CanvasSize = UDim2.new(0,0,0,0)

local TPBtn = Instance.new("TextButton", tabPages.Misc)
TPBtn.BackgroundColor3 = Color3.fromRGB(0,255,128)
TPBtn.Position = UDim2.new(0.05,0,0.45,0)
TPBtn.Size = UDim2.new(0.9,0,0,50)
TPBtn.Text = "TP to Selected"
TPBtn.TextColor3 = Color3.new(0,0,0)
TPBtn.TextScaled = true

local TrackBtn = Instance.new("TextButton", tabPages.Misc)
TrackBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
TrackBtn.Position = UDim2.new(0.05,0,0.55,0)
TrackBtn.Size = UDim2.new(0.9,0,0,50)
TrackBtn.Text = "Tracking: OFF"
TrackBtn.TextColor3 = Color3.fromRGB(200,200,200)
TrackBtn.TextScaled = true

local FlyBtn = Instance.new("TextButton", tabPages.Misc)
FlyBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
FlyBtn.Position = UDim2.new(0.05,0,0.65,0)
FlyBtn.Size = UDim2.new(0.9,0,0,50)
FlyBtn.Text = "Fly: OFF"
FlyBtn.TextColor3 = Color3.fromRGB(200,200,200)
FlyBtn.TextScaled = true

local NoclipBtn = Instance.new("TextButton", tabPages.Misc)
NoclipBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
NoclipBtn.Position = UDim2.new(0.05,0,0.75,0)
NoclipBtn.Size = UDim2.new(0.9,0,0,50)
NoclipBtn.Text = "Noclip: OFF"
NoclipBtn.TextColor3 = Color3.fromRGB(200,200,200)
NoclipBtn.TextScaled = true

local TPKeyLabel = Instance.new("TextLabel", tabPages.Misc)
TPKeyLabel.BackgroundTransparency = 1
TPKeyLabel.Position = UDim2.new(0.05,0,0.85,0)
TPKeyLabel.Size = UDim2.new(0.9,0,0,30)
TPKeyLabel.Text = "TP Key: Z"
TPKeyLabel.TextColor3 = Color3.fromRGB(0,255,128)
TPKeyLabel.TextScaled = true

-- Функции
local function toggleFly(state)
    flying = state
    local root = Player.Character and Player.Character.HumanoidRootPart
    if not root then return end
    if flying then
        bodyVelocity = Instance.new("BodyVelocity", root)
        bodyVelocity.MaxForce = Vector3.new(1e5,1e5,1e5)
        bodyVelocity.Velocity = Vector3.new()
        bodyGyro = Instance.new("BodyGyro", root)
        bodyGyro.MaxTorque = Vector3.new(1e5,1e5,1e5)
        spawn(function()
            while flying do
                local cam = WS.CurrentCamera
                local move = Vector3.new()
                if UIS:IsKeyDown(Enum.KeyCode.W) then move = move + cam.CFrame.LookVector end
                if UIS:IsKeyDown(Enum.KeyCode.S) then move = move - cam.CFrame.LookVector end
                if UIS:IsKeyDown(Enum.KeyCode.A) then move = move - cam.CFrame.RightVector end
                if UIS:IsKeyDown(Enum.KeyCode.D) then move = move + cam.CFrame.RightVector end
                if UIS:IsKeyDown(Enum.KeyCode.Space) then move = move + Vector3.new(0,1,0) end
                if UIS:IsKeyDown(Enum.KeyCode.LeftControl) then move = move - Vector3.new(0,1,0) end
                bodyVelocity.Velocity = move * 80
                bodyGyro.CFrame = cam.CFrame
                RS.Heartbeat:Wait()
            end
        end)
    else
        if bodyVelocity then bodyVelocity:Destroy() end
        if bodyGyro then bodyGyro:Destroy() end
    end
end

local function toggleNoclip(state)
    noclipping = state
    if noclipConn then noclipConn:Disconnect() end
    if noclipping then
        noclipConn = RS.Stepped:Connect(function()
            local char = Player.Character
            if char then
                for _, part in pairs(char:GetDescendants()) do
                    if part:IsA("BasePart") then part.CanCollide = false end
                end
            end
        end)
    end
end

-- Update Players
local function updatePlayers()
    for _, b in pairs(PlayersScroll:GetChildren()) do if b:IsA("TextButton") then b:Destroy() end end
    local y = 0
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= Player and p.Character then
            local btn = Instance.new("TextButton")
            btn.Parent = PlayersScroll
            btn.BackgroundColor3 = (selectedTarget == p) and Color3.fromRGB(0,100,50) or Color3.fromRGB(20,20,20)
            btn.Size = UDim2.new(1,-10,0,30)
            btn.Position = UDim2.new(0,5,0,y)
            btn.Text = p.Name
            btn.TextColor3 = Color3.fromRGB(255,255,255)
            btn.TextScaled = true
            btn.MouseButton1Click:Connect(function()
                selectedTarget = p
                updatePlayers()
            end
            y = y + 35
        end
    end
    PlayersScroll.CanvasSize = UDim2.new(0,0,0,y)
end

-- Anti-Grab (Defense)
spawn(function()
    while true do
        wait(0.1)
        if antiGrab then
            local char = Player.Character
            if char then
                for _, part in pairs(char:GetDescendants()) do
                    if part:IsA("BasePart") then part.CanCollide = false end
                end
            end
        end
    end
end)

-- Back TP (Defense)
spawn(function()
    while true do
        wait(0.2)
        if backTP then
            local char = Player.Character
            if char then
                for _, child in pairs(WS:GetChildren()) do
                    if child.Name == "GrabParts" and child:FindFirstChild("GrabPart") and child.GrabPart:FindFirstChildOfClass("WeldConstraint") and child.GrabPart.WeldConstraint.Part1 == char.HumanoidRootPart then
                        char.HumanoidRootPart.CFrame = char.HumanoidRootPart.CFrame * CFrame.new(0,0,-10)
                    end
                end
            end
        end
    end
end)

-- Extended Grab Reach and Pull (Attack)
spawn(function()
    while true do
        wait(0.1)
        if getgc then
            for _, func in pairs(getgc(true)) do
                if type(func) == "function" and getfenv(func).script == game.Players.LocalPlayer.PlayerScripts.LocalScript then
                    local consts = debug.getconstants(func)
                    for _, c in pairs(consts) do
                        if c == 100 then debug.setconstant(func, _, grabReach) end  -- reach
                        if c == 10 then debug.setconstant(func, _, pullStrength) end  -- pull
                    end
                end
            end
        end
    end
end)

-- Tracking (Misc)
spawn(function()
    while true do
        wait(0.05)
        if tracking and selectedTarget and selectedTarget.Character then
            local hrp = Player.Character and Player.Character.HumanoidRootPart
            if hrp then
                hrp.CFrame = selectedTarget.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,-5)  -- за спиной
            end
        end
    end
end)

-- Кнопки
AntiGrabBtn.MouseButton1Click:Connect(function()
    antiGrab = not antiGrab
    AntiGrabBtn.BackgroundColor3 = antiGrab and Color3.fromRGB(0,255,128) or Color3.fromRGB(80,80,80)
    AntiGrabBtn.Text = "Anti-Grab: " .. (antiGrab and "ON" or "OFF")
end)

BackTPBtn.MouseButton1Click:Connect(function()
    backTP = not backTP
    BackTPBtn.BackgroundColor3 = backTP and Color3.fromRGB(0,255,128) or Color3.fromRGB(80,80,80)
    BackTPBtn.Text = "Back TP on Grab: " .. (backTP and "ON" or "OFF")
end)

TPBtn.MouseButton1Click:Connect(function()
    if selectedTarget and selectedTarget.Character then
        local hrp = Player.Character and Player.Character.HumanoidRootPart
        if hrp then hrp.CFrame = selectedTarget.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,-6) end
    end
end)

TrackBtn.MouseButton1Click:Connect(function()
    tracking = not tracking
    TrackBtn.BackgroundColor3 = tracking and Color3.fromRGB(0,255,128) or Color3.fromRGB(80,80,80)
    TrackBtn.Text = "Tracking: " .. (tracking and "ON" or "OFF")
end)

FlyBtn.MouseButton1Click:Connect(function()
    toggleFly(not flying)
    FlyBtn.BackgroundColor3 = flying and Color3.fromRGB(0,255,128) or Color3.fromRGB(80,80,80)
    FlyBtn.Text = "Fly: " .. (flying and "ON" or "OFF")
end)

NoclipBtn.MouseButton1Click:Connect(function()
    toggleNoclip(not noclipping)
    NoclipBtn.BackgroundColor3 = noclipping and Color3.fromRGB(0,255,128) or Color3.fromRGB(80,80,80)
    NoclipBtn.Text = "Noclip: " .. (noclipping and "ON" or "OFF")
end)

-- Slider Reach
local draggingReach = false
SliderTrackReach.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then draggingReach = true end end)
UIS.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then draggingReach = false end end)
RS.RenderStepped:Connect(function()
    if draggingReach then
        local rel = math.clamp((Mouse.X - SliderTrackReach.AbsolutePosition.X) / SliderTrackReach.AbsoluteSize.X, 0, 1)
        SliderFillReach.Size = UDim2.new(rel,0,1,0)
        grabReach = math.floor(50 + 950 * rel)
        ReachLabel.Text = "Grab Reach: " .. grabReach
    end
end)

-- Slider Pull
local draggingPull = false
SliderTrackPull.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then draggingPull = true end end)
UIS.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then draggingPull = false end end)
RS.RenderStepped:Connect(function()
    if draggingPull then
        local rel = math.clamp((Mouse.X - SliderTrackPull.AbsolutePosition.X) / SliderTrackPull.AbsoluteSize.X, 0, 1)
        SliderFillPull.Size = UDim2.new(rel,0,1,0)
        pullStrength = math.floor(5 + 95 * rel)
        PullStrengthLabel.Text = "Pull Strength (Wheel): " .. pullStrength
    end
end)

-- Slider Throw
local draggingThrow = false
SliderTrackThrow.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then draggingThrow = true end end)
UIS.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then draggingThrow = false end end)
RS.RenderStepped:Connect(function()
    if draggingThrow then
        local rel = math.clamp((Mouse.X - SliderTrackThrow.AbsolutePosition.X) / SliderTrackThrow.AbsoluteSize.X, 0, 1)
        SliderFillThrow.Size = UDim2.new(rel,0,1,0)
        throwStrength = math.floor(500 + 4500 * rel)
        ThrowStrengthLabel.Text = "Throw Strength (RMB): " .. throwStrength
    end
end)

-- Авто-обновление списка игроков
spawn(function()
    while true do
        wait(5)
        updatePlayers()
    end
end)

-- TP on Z
UIS.InputBegan:Connect(function(input)
    if input.KeyCode == tpKey then
        if selectedTarget and selectedTarget.Character then
            local hrp = Player.Character and Player.Character.HumanoidRootPart
            if hrp then hrp.CFrame = selectedTarget.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,-6) end
        end
    end
end)

-- Инит
updatePlayers()
updateToys()
CloseBtn.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
end)

UIS.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.Insert then
        MainFrame.Visible = not MainFrame.Visible
    end
end)
